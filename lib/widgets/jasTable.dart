//{
  //"jas_conversion": {
    //"radiata_pine": {
      //"3.0-5.9": {
        //"10-20": { "0.4-0.79": 0.887, "0.8-1.19": 0.809, "1.2-1.59": 0.753, "1.6-1.99": 0.690, "2.0-2.39": 0.651 },
        //"20-30": { "0.4-0.79": 0.925, "0.8-1.19": 0.880, "1.2-1.59": 0.837, "1.6-1.99": 0.815, "2.0-2.39": 0.782 },
        //"30-40": { "0.4-0.79": 0.970, "0.8-1.19": 0.937, "1.2-1.59": 0.901, "1.6-1.99": 0.879, "2.0-2.39": 0.854 }
      //},
      //"6.0-8.9": {
        //"10-20": { "0.4-0.79": 1.115, "0.8-1.19": 0.942, "1.2-1.59": 0.795, "1.6-1.99": 0.662, "2.0-2.39": 0.566 },
        //"20-30": { "0.4-0.79": 1.119, "0.8-1.19": 1.033, "1.2-1.59": 0.942, "1.6-1.99": 0.867, "2.0-2.39": 0.799 },
        //"30-40": { "0.4-0.79": 1.127, "0.8-1.19": 1.068, "1.2-1.59": 1.022, "1.6-1.99": 0.959, "2.0-2.39": 0.901 }
      //},
      //"9.0-11.9": {
        //"10-20": { "0.4-0.79": 1.115, "0.8-1.19": 0.942, "1.2-1.59": 0.795, "1.6-1.99": 0.662, "2.0-2.39": 0.566 },
        //"20-30": { "0.4-0.79": 1.119, "0.8-1.19": 1.033, "1.2-1.59": 0.942, "1.6-1.99": 0.867, "2.0-2.39": 0.799 },
        //"30-40": { "0.4-0.79": 1.127, "0.8-1.19": 1.068, "1.2-1.59": 1.022, "1.6-1.99": 0.959, "2.0-2.39": 0.901 }
      //}
    //},
    //"douglas_fir": {
      //"3.0-5.9": {
        //"10-20": { "0.4-0.79": 1.115, "0.8-1.19": 0.942, "1.2-1.59": 0.795, "1.6-1.99": 0.662, "2.0-2.39": 0.566 },
        //"20-30": { "0.4-0.79": 1.119, "0.8-1.19": 1.033, "1.2-1.59": 0.942, "1.6-1.99": 0.867, "2.0-2.39": 0.799 },
        //"30-40": { "0.4-0.79": 1.127, "0.8-1.19": 1.068, "1.2-1.59": 1.022, "1.6-1.99": 0.959, "2.0-2.39": 0.901 }
      //},
      //"6.0-8.9": {
        //"10-20": { "0.4-0.79": 1.115, "0.8-1.19": 0.942, "1.2-1.59": 0.795, "1.6-1.99": 0.662, "2.0-2.39": 0.566 },
        //"20-30": { "0.4-0.79": 1.119, "0.8-1.19": 1.033, "1.2-1.59": 0.942, "1.6-1.99": 0.867, "2.0-2.39": 0.799 },
        //"30-40": { "0.4-0.79": 1.127, "0.8-1.19": 1.068, "1.2-1.59": 1.022, "1.6-1.99": 0.959, "2.0-2.39": 0.901 }
      //},
      //"9.0-11.9": {
        //"10-20": { "0.4-0.79": 1.115, "0.8-1.19": 0.942, "1.2-1.59": 0.795, "1.6-1.99": 0.662, "2.0-2.39": 0.566 },
        //"20-30": { "0.4-0.79": 1.119, "0.8-1.19": 1.033, "1.2-1.59": 0.942, "1.6-1.99": 0.867, "2.0-2.39": 0.799 },
        //"30-40": { "0.4-0.79": 1.127, "0.8-1.19": 1.068, "1.2-1.59": 1.022, "1.6-1.99": 0.959, "2.0-2.39": 0.901 }
      //}
    //}
  //}
//}
final List<Map<String, dynamic>> jasTable = [
  // radiata_pine
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '0.4-0.79', 'coef': 0.887},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '0.8-1.19', 'coef': 0.809},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '1.2-1.59', 'coef': 0.753},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '1.6-1.99', 'coef': 0.690},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '2.0-2.39', 'coef': 0.651},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '0.4-0.79', 'coef': 0.925},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '0.8-1.19', 'coef': 0.880},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '1.2-1.59', 'coef': 0.837},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '1.6-1.99', 'coef': 0.815},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '2.0-2.39', 'coef': 0.782},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '0.4-0.79', 'coef': 0.970},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '0.8-1.19', 'coef': 0.937},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '1.2-1.59', 'coef': 0.901},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '1.6-1.99', 'coef': 0.879},
  {'species': 'radiata_pine', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '2.0-2.39', 'coef': 0.854},

  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '0.4-0.79', 'coef': 1.115},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '0.8-1.19', 'coef': 0.942},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '1.2-1.59', 'coef': 0.795},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '1.6-1.99', 'coef': 0.662},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '2.0-2.39', 'coef': 0.566},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '0.4-0.79', 'coef': 1.119},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '0.8-1.19', 'coef': 1.033},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '1.2-1.59', 'coef': 0.942},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '1.6-1.99', 'coef': 0.867},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '2.0-2.39', 'coef': 0.799},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '0.4-0.79', 'coef': 1.127},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '0.8-1.19', 'coef': 1.068},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '1.2-1.59', 'coef': 1.022},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '1.6-1.99', 'coef': 0.959},
  {'species': 'radiata_pine', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '2.0-2.39', 'coef': 0.901},

  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '0.4-0.79', 'coef': 1.115},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '0.8-1.19', 'coef': 0.942},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '1.2-1.59', 'coef': 0.795},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '1.6-1.99', 'coef': 0.662},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '2.0-2.39', 'coef': 0.566},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '0.4-0.79', 'coef': 1.119},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '0.8-1.19', 'coef': 1.033},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '1.2-1.59', 'coef': 0.942},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '1.6-1.99', 'coef': 0.867},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '2.0-2.39', 'coef': 0.799},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '0.4-0.79', 'coef': 1.127},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '0.8-1.19', 'coef': 1.068},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '1.2-1.59', 'coef': 1.022},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '1.6-1.99', 'coef': 0.959},
  {'species': 'radiata_pine', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '2.0-2.39', 'coef': 0.901},

  // douglas_fir
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '0.4-0.79', 'coef': 1.115},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '0.8-1.19', 'coef': 0.942},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '1.2-1.59', 'coef': 0.795},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '1.6-1.99', 'coef': 0.662},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '10-20', 'density': '2.0-2.39', 'coef': 0.566},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '0.4-0.79', 'coef': 1.119},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '0.8-1.19', 'coef': 1.033},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '1.2-1.59', 'coef': 0.942},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '1.6-1.99', 'coef': 0.867},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '20-30', 'density': '2.0-2.39', 'coef': 0.799},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '0.4-0.79', 'coef': 1.127},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '0.8-1.19', 'coef': 1.068},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '1.2-1.59', 'coef': 1.022},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '1.6-1.99', 'coef': 0.959},
  {'species': 'douglas_fir', 'lengthM': '3.0-5.9', 'diameterCm': '30-40', 'density': '2.0-2.39', 'coef': 0.901},

  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '0.4-0.79', 'coef': 1.115},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '0.8-1.19', 'coef': 0.942},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '1.2-1.59', 'coef': 0.795},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '1.6-1.99', 'coef': 0.662},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '10-20', 'density': '2.0-2.39', 'coef': 0.566},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '0.4-0.79', 'coef': 1.119},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '0.8-1.19', 'coef': 1.033},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '1.2-1.59', 'coef': 0.942},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '1.6-1.99', 'coef': 0.867},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '20-30', 'density': '2.0-2.39', 'coef': 0.799},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '0.4-0.79', 'coef': 1.127},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '0.8-1.19', 'coef': 1.068},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '1.2-1.59', 'coef': 1.022},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '1.6-1.99', 'coef': 0.959},
  {'species': 'douglas_fir', 'lengthM': '6.0-8.9', 'diameterCm': '30-40', 'density': '2.0-2.39', 'coef': 0.901},

  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '0.4-0.79', 'coef': 1.115},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '0.8-1.19', 'coef': 0.942},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '1.2-1.59', 'coef': 0.795},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '1.6-1.99', 'coef': 0.662},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '10-20', 'density': '2.0-2.39', 'coef': 0.566},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '0.4-0.79', 'coef': 1.119},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '0.8-1.19', 'coef': 1.033},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '1.2-1.59', 'coef': 0.942},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '1.6-1.99', 'coef': 0.867},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '20-30', 'density': '2.0-2.39', 'coef': 0.799},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '0.4-0.79', 'coef': 1.127},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '0.8-1.19', 'coef': 1.068},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '1.2-1.59', 'coef': 1.022},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '1.6-1.99', 'coef': 0.959},
  {'species': 'douglas_fir', 'lengthM': '9.0-11.9', 'diameterCm': '30-40', 'density': '2.0-2.39', 'coef': 0.901},
];
/// Поиск коэффициента JAS по породе, диапазону длины, диапазону диаметра и диапазону плотности.
/// Возвращает коэффициент или null, если не найдено.
/// Возвращает коэффициент JAS по длине и диаметру (берёт первую подходящую запись для radiata_pine и плотности 0.4-0.79)
double roundDiameterForJAS(double d) {
  if (d < 14) return d.floorToDouble();
  return (d ~/ 2) * 2.0;
}

double? getJasCoef(
  double length,
  double diameter, {
  String species = 'radiata_pine',
  String density = '0.8-1.19',
}) {
  String? lengthRange;
  String? diameterRange;

  // НЕ округляй diameter здесь!
  // double roundedDiameter = roundDiameterForJAS(diameter);

  // Определяем диапазон длины
  if (length >= 3.0 && length <= 5.9) {
    lengthRange = '3.0-5.9';
  } else if (length >= 6.0 && length <= 8.9) {
    lengthRange = '6.0-8.9';
  } else if (length >= 9.0 && length <= 11.9) {
    lengthRange = '9.0-11.9';
  } else {
    return null; // длина вне диапазона
  }

  // Определяем диапазон диаметра
  if (diameter >= 10 && diameter < 20) {
  diameterRange = '10-20';
  } else if (diameter >= 20 && diameter < 30) {
    diameterRange = '20-30';
  } else if (diameter >= 30 && diameter < 40) {
    diameterRange = '30-40';
  } else {
    return null; // диаметр вне диапазона
  }

  // Ищем в таблице
  final match = jasTable.firstWhere(
    (row) =>
        row['species'] == species &&
        row['lengthM'] == lengthRange &&
        row['diameterCm'] == diameterRange &&
        row['density'] == density,
    orElse: () => {},
  );

  return match['coef'] as double?;
}
double volumeNeller(double diameter, double length) {
  // Примерная формула цилиндра, замените на свою если нужно!
  return 3.14159 * (diameter / 2) * (diameter / 2) * length;
}